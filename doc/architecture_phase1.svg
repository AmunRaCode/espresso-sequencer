<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1443px" preserveAspectRatio="none" style="width:1180px;height:1443px;background:#FFFFFF;" version="1.1" viewBox="0 0 1180 1443" width="1180px" zoomAndPan="magnify"><defs/><g><!--MD5=[f7217341b3bb6bbf768c7f0e049f8d09]
cluster Legend--><g id="cluster_Legend"><rect fill="none" height="87" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1.0;" width="474" x="101.18" y="208.34"/><path d="M162.18,208.34 L162.18,217.8283 L152.18,227.8283 L101.18,227.8283 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="51" x="104.18" y="222.8752">Legend</text></g><!--MD5=[3746f487d7820090e32c72dc756be46d]
cluster HotShotExternal--><g id="cluster_HotShotExternal"><path d="M1038.68,192.34 L1160.68,192.34 A3.75,3.75 0 0 1 1163.18,194.84 L1170.18,231.3166 L1170.68,231.3166 A2.5,2.5 0 0 1 1173.18,233.8166 L1173.18,292.84 A2.5,2.5 0 0 1 1170.68,295.34 L1038.68,295.34 A2.5,2.5 0 0 1 1036.18,292.84 L1036.18,194.84 A2.5,2.5 0 0 1 1038.68,192.34 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1036.18" x2="1170.18" y1="231.3166" y2="231.3166"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="58" x="1071.68" y="207.8752">HotShot</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="121" x="1040.18" y="224.3634">(other instances)</text></g><!--MD5=[074479fc2b8718e85f223949db21494f]
cluster Decentralized Sequencer--><g id="cluster_Decentralized Sequencer"><path d="M633.68,63.34 L809.68,63.34 A3.75,3.75 0 0 1 812.18,65.84 L819.18,85.8283 L1009.68,85.8283 A2.5,2.5 0 0 1 1012.18,88.3283 L1012.18,471.84 A2.5,2.5 0 0 1 1009.68,474.34 L633.68,474.34 A2.5,2.5 0 0 1 631.18,471.84 L631.18,65.84 A2.5,2.5 0 0 1 633.68,63.34 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="631.18" x2="819.18" y1="85.8283" y2="85.8283"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="175" x="635.18" y="78.8752">Decentralized Sequencer</text></g><!--MD5=[bcfbdd31683a7d01cd062dc0c4be3661]
cluster zkApp--><g id="cluster_zkApp"><path d="M657.68,106.34 L737.68,106.34 A3.75,3.75 0 0 1 740.18,108.84 L747.18,128.8283 L985.68,128.8283 A2.5,2.5 0 0 1 988.18,131.3283 L988.18,447.84 A2.5,2.5 0 0 1 985.68,450.34 L657.68,450.34 A2.5,2.5 0 0 1 655.18,447.84 L655.18,108.84 A2.5,2.5 0 0 1 657.68,106.34 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="655.18" x2="747.18" y1="128.8283" y2="128.8283"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="79" x="659.18" y="121.8752">zkEVM app</text></g><!--MD5=[975d7fda8cf98ff1a26ca528bf10cecf]
cluster App--><g id="cluster_App"><path d="M689.68,157.34 L881.68,157.34 A3.75,3.75 0 0 1 884.18,159.84 L891.18,179.8283 L953.68,179.8283 A2.5,2.5 0 0 1 956.18,182.3283 L956.18,324.84 A2.5,2.5 0 0 1 953.68,327.34 L689.68,327.34 A2.5,2.5 0 0 1 687.18,324.84 L687.18,159.84 A2.5,2.5 0 0 1 689.68,157.34 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="687.18" x2="891.18" y1="179.8283" y2="179.8283"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="191" x="691.18" y="172.8752">Txn-ordering HotShot app</text></g><!--MD5=[583d55fc1e2a49743832e160d5573292]
cluster HotShot--><g id="cluster_HotShot"><path d="M721.68,208.34 L780.68,208.34 A3.75,3.75 0 0 1 783.18,210.84 L790.18,230.8283 L913.68,230.8283 A2.5,2.5 0 0 1 916.18,233.3283 L916.18,292.84 A2.5,2.5 0 0 1 913.68,295.34 L721.68,295.34 A2.5,2.5 0 0 1 719.18,292.84 L719.18,210.84 A2.5,2.5 0 0 1 721.68,208.34 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="719.18" x2="790.18" y1="230.8283" y2="230.8283"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="58" x="723.18" y="223.8752">HotShot</text></g><!--MD5=[6d298098a9fb99b91beb7284131f18dc]
cluster Adaptor--><g id="cluster_Adaptor"><path d="M743.68,531.34 L823.68,531.34 A3.75,3.75 0 0 1 826.18,533.84 L833.18,553.8283 L983.68,553.8283 A2.5,2.5 0 0 1 986.18,556.3283 L986.18,653.84 A2.5,2.5 0 0 1 983.68,656.34 L743.68,656.34 A2.5,2.5 0 0 1 741.18,653.84 L741.18,533.84 A2.5,2.5 0 0 1 743.68,531.34 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="741.18" x2="833.18" y1="553.8283" y2="553.8283"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="79" x="745.18" y="546.8752">L2 Adaptor</text></g><!--MD5=[4499c58aefeb8777a4ef8729a6b9746a]
cluster L1--><g id="cluster_L1"><path d="M475.68,1349.34 L566.68,1349.34 A3.75,3.75 0 0 1 569.18,1351.84 L576.18,1371.8283 L630.68,1371.8283 A2.5,2.5 0 0 1 633.18,1374.3283 L633.18,1433.84 A2.5,2.5 0 0 1 630.68,1436.34 L475.68,1436.34 A2.5,2.5 0 0 1 473.18,1433.84 L473.18,1351.84 A2.5,2.5 0 0 1 475.68,1349.34 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="473.18" x2="576.18" y1="1371.8283" y2="1371.8283"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="90" x="477.18" y="1364.8752">Ethereum L1</text></g><!--MD5=[30107c386ad61863a1077fa9b8608265]
cluster L2--><g id="cluster_L2"><path d="M63.68,713.34 L187.68,713.34 A3.75,3.75 0 0 1 190.18,715.84 L197.18,735.8283 L589.68,735.8283 A2.5,2.5 0 0 1 592.18,738.3283 L592.18,1282.84 A2.5,2.5 0 0 1 589.68,1285.34 L63.68,1285.34 A2.5,2.5 0 0 1 61.18,1282.84 L61.18,715.84 A2.5,2.5 0 0 1 63.68,713.34 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="61.18" x2="197.18" y1="735.8283" y2="735.8283"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="123" x="65.18" y="728.8752">L2 (zkevm-node)</text></g><!--MD5=[72078431e26b572f5b2226d95bfc722b]
cluster HermezProver--><g id="cluster_HermezProver"><path d="M100.68,1042.34 L207.68,1042.34 A3.75,3.75 0 0 1 210.18,1044.84 L217.18,1064.8283 L444.68,1064.8283 A2.5,2.5 0 0 1 447.18,1067.3283 L447.18,1152.84 A2.5,2.5 0 0 1 444.68,1155.34 L100.68,1155.34 A2.5,2.5 0 0 1 98.18,1152.84 L98.18,1044.84 A2.5,2.5 0 0 1 100.68,1042.34 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="98.18" x2="217.18" y1="1064.8283" y2="1064.8283"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="106" x="102.18" y="1057.8752">Hermez Prover</text></g><!--MD5=[72d9b9c3df19f32920b704ceb461b044]
entity Original--><g id="elem_Original"><rect fill="#98FB98" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="151" x="200.68" y="243.34"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131" x="210.68" y="266.8752">zkevm-node "as is"</text></g><!--MD5=[a113189431ad531dd682dcf46ceaaad4]
entity Modified--><g id="elem_Modified"><rect fill="#FFB6C1" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="387.18" y="243.34"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152" x="397.18" y="266.8752">zkevm-node modified</text></g><!--MD5=[f6b1c2ab19eda0ce2a089c48ec5bcba4]
entity New--><g id="elem_New"><rect fill="#F1F1F1" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="48" x="117.18" y="243.34"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="127.18" y="266.8752">new</text></g><!--MD5=[896ddc638b163aeba3d9eafdbb3e5908]
entity GossipExternal--><g id="elem_GossipExternal"><rect fill="#F1F1F1" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66" x="1052.18" y="243.34"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="1062.18" y="266.8752">Gossip</text></g><!--MD5=[87e9134534c374160597a990a0538c50]
entity QueryService--><g id="elem_QueryService"><rect fill="#F1F1F1" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="681.68" y="398.34"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="691.68" y="421.8752">Query Service</text></g><!--MD5=[fc241586e3e4cf255457dad9b5d09a8f]
entity Submit--><g id="elem_Submit"><rect fill="#F1F1F1" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="830.18" y="398.34"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="840.18" y="421.8752">Submit API</text></g><!--MD5=[72906ce1eb61e5bac7b26d06e51547ad]
entity GossipInternal--><g id="elem_GossipInternal"><rect fill="#F1F1F1" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66" x="834.18" y="243.34"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="844.18" y="266.8752">Gossip</text></g><!--MD5=[657580825c081e24058a2374906e8018]
entity HotShotEvents--><g id="elem_HotShotEvents"><rect fill="#F1F1F1" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="735.18" y="243.34"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="745.18" y="266.8752">Events</text></g><!--MD5=[6b8e50089b1fd2a85522717fdde0e9ec]
entity AdaptorSubmit--><g id="elem_AdaptorSubmit"><ellipse cx="873.18" cy="603.34" fill="#F1F1F1" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="162" x="792.18" y="633.8752">JSON-RPC (submit only)</text></g><!--MD5=[02772cf4a850889cc654a495925d36fb]
entity Rollup--><g id="elem_Rollup"><rect fill="#98FB98" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127" x="489.68" y="1384.34"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="499.68" y="1407.8752">Rollup Contract</text></g><!--MD5=[ee57f16ef1ba8b49a548a5b41deaf6ed]
entity JsonRPC--><g id="elem_JsonRPC"><rect fill="#98FB98" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="76" x="493.18" y="750.84"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="503.18" y="774.3752">JsonRPC</text></g><g id="elem_GMN25"><path d="M212.18,748.34 L212.18,788.9611 A0,0 0 0 0 212.18,788.9611 L458.18,788.9611 A0,0 0 0 0 458.18,788.9611 L458.18,772.84 L492.82,768.84 L458.18,764.84 L458.18,758.34 L448.18,748.34 L212.18,748.34 A0,0 0 0 0 212.18,748.34 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M448.18,748.34 L448.18,758.34 L458.18,758.34 L448.18,748.34 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="218.18" y="765.9084">Configured to forward transactions</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="218.18" y="781.2189">to the Submit API of the L2 adaptor.</text></g><!--MD5=[58f3bb20197d49c7ea139ae014477a42]
entity L2DB--><g id="elem_L2DB"><path d="M440.68,910.34 C440.68,900.34 508.18,900.34 508.18,900.34 C508.18,900.34 575.68,900.34 575.68,910.34 L575.68,935.8283 C575.68,945.8283 508.18,945.8283 508.18,945.8283 C508.18,945.8283 440.68,945.8283 440.68,935.8283 L440.68,910.34 " fill="#98FB98" style="stroke:#181818;stroke-width:0.5;"/><path d="M440.68,910.34 C440.68,920.34 508.18,920.34 508.18,920.34 C508.18,920.34 575.68,920.34 575.68,910.34 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="450.68" y="937.8752">L2 Blockchain DB</text></g><!--MD5=[45978046dcd5eebeac2fa904e53c0036]
entity Etherman--><g id="elem_Etherman"><rect fill="#98FB98" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="434.18" y="1233.34"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="444.18" y="1256.8752">Etherman</text></g><!--MD5=[30dc00a6e98b45ee3ed5a73adbca65de]
entity Aggregator--><g id="elem_Aggregator"><rect fill="#98FB98" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="77.68" y="750.84"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="87.68" y="774.3752">Aggregator</text></g><!--MD5=[5c691934b5633fdd3b98f008c74cebb5]
entity State--><g id="elem_State"><rect fill="#98FB98" height="52.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="309.68" y="896.34"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34" x="319.68" y="919.8752">State</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="319.68" y="936.3634">Library</text></g><!--MD5=[a72c5f357cbb840cbfe5ce2fc3e89c42]
entity Synchronizer--><g id="elem_Synchronizer"><rect fill="#98FB98" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="466.18" y="1090.34"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90" x="476.18" y="1113.8752">Synchronizer</text></g><!--MD5=[c3bd79b6cca3d8fa787b3b807ac7237d]
entity Prover--><g id="elem_Prover"><rect fill="#98FB98" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="114.18" y="1090.34"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="124.18" y="1113.8752">Prover</text></g><!--MD5=[77b6810f9f1d8e17e1346401c10c77dc]
entity Executor--><g id="elem_Executor"><rect fill="#98FB98" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="213.68" y="1090.34"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="223.68" y="1113.8752">Executor</text></g><!--MD5=[47b51ac2f4ace7439b689a6295ba6363]
entity Tree--><g id="elem_Tree"><path d="M329.68,1087.34 C329.68,1077.34 380.18,1077.34 380.18,1077.34 C380.18,1077.34 430.68,1077.34 430.68,1087.34 L430.68,1129.3166 C430.68,1139.3166 380.18,1139.3166 380.18,1139.3166 C380.18,1139.3166 329.68,1139.3166 329.68,1129.3166 L329.68,1087.34 " fill="#98FB98" style="stroke:#181818;stroke-width:0.5;"/><path d="M329.68,1087.34 C329.68,1097.34 380.18,1097.34 380.18,1097.34 C380.18,1097.34 430.68,1097.34 430.68,1087.34 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="339.68" y="1114.8752">L2 State DB</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="339.68" y="1131.3634">Merkle Tree</text></g><!--MD5=[fee662a292a0353a69bd162820bae93b]
entity User--><g id="elem_User"><rect fill="#FFFFFF" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51" x="670.68" y="750.84"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="680.68" y="774.3752">User</text></g><!--MD5=[12c5fa856046bf0246c20874f4cc4349]
link New to Original--><!--MD5=[e97aaf9ac7fa8317af7932e9b00233fd]
link Original to Modified--><!--MD5=[41bf5c2ff0458362cd2ec6a26f1e4ae9]
link User to JsonRPC--><g id="link_User_JsonRPC"><path d="M670.44,768.84 C645.17,768.84 606.11,768.84 575.78,768.84 " fill="none" id="User-to-JsonRPC" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="570.96,768.84,579.96,772.84,575.96,768.84,579.96,764.84,570.96,768.84" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="594.43" y="747.4084">EVM txn</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="587.43" y="762.7189">EVM query</text></g><!--MD5=[93ef827bccd854f4cfe4930d6155b2fc]
reverse link AdaptorSubmit to JsonRPC--><g id="link_AdaptorSubmit_JsonRPC"><path d="M860.25,616.3 C843.17,631.47 811.57,657.46 780.18,672.34 C727.49,697.33 707.68,684.59 653.18,705.34 C620.26,717.87 584.63,736.8 560.42,750.55 " fill="none" id="AdaptorSubmit-backto-JsonRPC" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="863.54,613.33,854.1745,616.3775,859.8235,616.6748,859.5262,622.3239,863.54,613.33" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="760.18" y="693.9084">EVM txn</text></g><!--MD5=[0c3330e419e692381ee341e21f07b761]
reverse link Submit to AdaptorSubmit--><g id="link_Submit_AdaptorSubmit"><path d="M876.67,441.1 C875.76,483.09 873.91,568.46 873.35,594.57 " fill="none" id="Submit-backto-AdaptorSubmit" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="876.77,436.26,872.5908,445.1782,876.67,441.259,880.5892,445.3382,876.77,436.26" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="876.18" y="503.9084">EVM txn</text></g><!--MD5=[91cafd777a61df7305284aff3f8c2f32]
link GossipInternal to GossipExternal--><g id="link_GossipInternal_GossipExternal"><path d="M863.01,236.65 C855.83,184.88 848.28,67.49 921.68,40.34 C1014.51,6 1064.23,172.32 1079.77,236.74 " fill="none" id="GossipInternal-GossipExternal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="863.7,241.43,866.3717,231.9504,862.9849,236.4814,858.4539,233.0946,863.7,241.43" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1080.9,241.53,1082.7386,231.8543,1079.758,236.6622,1074.9501,233.6815,1080.9,241.53" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0beadb0f8f8b648fe3685e1f42645ee9]
link QueryService to Adaptor--><g id="link_QueryService_Adaptor"><path d="M739.21,434.74 C739.885,446.075 740.8319,461.9812 741.8758,479.5223 C742.3977,488.2929 742.9439,497.4721 743.4926,506.6931 C743.7669,511.3035 744.0418,515.9244 744.3145,520.5098 C744.4509,522.8025 744.5868,525.0863 744.7218,527.3556 C744.7893,528.4902 744.8565,529.6212 744.9235,530.7478 " fill="none" id="QueryService-to-Adaptor" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="744.9235,530.7478,748.3821,521.5261,744.6267,525.7566,740.3962,522.0011,744.9235,530.7478" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="744.18" y="503.9084">batch</text></g><!--MD5=[8170ee5a3887cbb09eb1ab2db1c65a5d]
link Adaptor to Rollup--><g id="link_Adaptor_Rollup"><path d="M761.7366,656.345 C761.7866,656.5853 761.8365,656.8262 761.8865,657.0677 C762.0864,658.0334 762.2864,659.0081 762.4862,659.9913 C768.8825,691.4525 775.18,731.625 775.18,767.84 C775.18,767.84 775.18,767.84 775.18,1252.34 C775.18,1326.65 688.37,1366.29 623.32,1385.56 " fill="none" id="Adaptor-to-Rollup" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="618.55,1386.94,628.31,1388.26,623.35,1385.54,626.07,1380.58,618.55,1386.94" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="776.18" y="1007.9084">ForceBatches(batch)</text></g><!--MD5=[a8703da4667deee7d0af4e44f6a9eb71]
link JsonRPC to State--><g id="link_JsonRPC_State"><path d="M509.61,787.28 C477.92,812.9 418.34,861.07 379.73,892.29 " fill="none" id="JsonRPC-to-State" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="376.31,895.06,385.8231,892.5102,380.1976,891.9157,380.7921,886.2901,376.31,895.06" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="465.18" y="847.9084">EVM query</text></g><!--MD5=[23b06c96c58f9e52170abd90e351db28]
link State to L2DB--><g id="link_State_L2DB"><path d="M376.97,922.84 C393.47,922.84 414.03,922.84 433.94,922.84 " fill="none" id="State-to-L2DB" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="438.86,922.84,429.86,918.84,433.86,922.84,429.86,926.84,438.86,922.84" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="395.18" y="916.4084">read</text></g><!--MD5=[afe8f3baa15dd48ff669bede90c045bc]
link State to Tree--><g id="link_State_Tree"><path d="M348.4,949.74 C354.79,981.4 365.63,1035.17 372.85,1070.97 " fill="none" id="State-to-Tree" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="373.76,1075.51,375.9065,1065.8979,372.7739,1070.6082,368.0636,1067.4756,373.76,1075.51" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="363.18" y="1007.9084">accounts</text></g><!--MD5=[723ab0c1c62c5caa555c3ea1e025083c]
link State to Executor--><g id="link_State_Executor"><path d="M314.17,949.71 C305.77,958.42 297.25,968.67 291.18,979.34 C272.1,1012.89 262.17,1057.08 257.57,1083.79 " fill="none" id="State-to-Executor" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="256.76,1088.7,262.1736,1080.4724,257.575,1083.7669,254.2806,1079.1683,256.76,1088.7" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="292.18" y="1007.9084">call, etc.</text></g><!--MD5=[9c0e57ae8e5f1edce66b3ebcdb296dbe]
link Aggregator to State--><g id="link_Aggregator_State"><path d="M151.96,787.28 C189.23,813.5 260.05,863.34 304.26,894.45 " fill="none" id="Aggregator-to-State" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="308.27,897.28,303.2066,888.8324,304.1792,894.405,298.6066,895.3776,308.27,897.28" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="265.18" y="832.9084">fetch</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="261.18" y="848.2189">prover</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="264.68" y="863.5295">input</text></g><!--MD5=[5351e065096d48a231f9189815b4e2c0]
link Aggregator to Etherman--><g id="link_Aggregator_Etherman"><path d="M118.53,787.18 C90.02,847.03 6,1047.6 98.18,1163.34 C138.83,1214.38 334.19,1237.95 427.44,1246.43 " fill="none" id="Aggregator-to-Etherman" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="432.19,1246.85,423.5792,1242.0694,427.2096,1246.4076,422.8714,1250.038,432.19,1246.85" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34" x="60.18" y="1007.9084">proof</text></g><!--MD5=[134f1ee58a0da627c1fcf646a8cf7cfa]
link Aggregator to Prover--><g id="link_Aggregator_Prover"><path d="M131.25,787.2 C140.47,828.52 161.74,935.98 156.18,1026.34 C154.98,1045.82 152.18,1067.78 149.84,1083.92 " fill="none" id="Aggregator-to-Prover" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="149.17,1088.52,154.4362,1080.1973,149.8971,1083.5731,146.5212,1079.034,149.17,1088.52" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="157.18" y="920.4084">generate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34" x="167.18" y="935.7189">proof</text></g><!--MD5=[0ca7d036d4fc0c343f6b4beaa6721ac7]
link Etherman to Rollup--><g id="link_Etherman_Rollup"><path d="M472.2,1269.66 C468.27,1286.68 464.85,1313 474.18,1333.34 C483.14,1352.87 500.78,1368.91 517.12,1380.5 " fill="none" id="Etherman-to-Rollup" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="520.89,1383.09,515.7262,1374.7034,516.7652,1380.264,511.2046,1381.3031,520.89,1383.09" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34" x="475.18" y="1322.4084">proof</text></g><!--MD5=[a4d6cd79a155cfbcb323877c4aae9e64]
reverse link Etherman to Rollup--><g id="link_Etherman_Rollup"><path d="M495.98,1274.54 C502.28,1282.64 509.02,1292.09 514.18,1301.34 C529.53,1328.84 541.61,1363.61 548.05,1384.07 " fill="none" id="Etherman-backto-Rollup" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="493.07,1270.86,495.5219,1280.3988,496.1742,1274.7796,501.7934,1275.432,493.07,1270.86" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="561.18" y="1314.9084">batch</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="530.18" y="1330.2189">global exit root</text></g><!--MD5=[072d55d1719c6ddeff0aa0b488c75fd6]
reverse link Synchronizer to Etherman--><g id="link_Synchronizer_Etherman"><path d="M513.89,1132.69 C505.09,1160.89 490.5,1207.67 482.62,1232.91 " fill="none" id="Synchronizer-backto-Etherman" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="515.33,1128.07,508.8352,1135.4739,513.8435,1132.8439,516.4735,1137.8523,515.33,1128.07" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="533.18" y="1184.9084">batch</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="502.18" y="1200.2189">global exit root</text></g><!--MD5=[e6872b51cd447c4cbbb81a6b7ab368dd]
reverse link State to Synchronizer--><g id="link_State_Synchronizer"><path d="M382.72,945.07 C398.16,954.42 415.42,966.25 429.18,979.34 C465.27,1013.67 496.54,1063.88 511.61,1090.04 " fill="none" id="State-backto-Synchronizer" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="378.42,942.52,384.111,950.5582,382.7175,945.0757,388.2,943.6822,378.42,942.52" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="500.18" y="992.9084">batch</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="469.18" y="1008.2189">global exit root</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="502.18" y="1023.5295">state</text></g><!--MD5=[eb6b988b0512d6b84233d2583692179c]
reverse link App to Submit--><g id="link_App_Submit"><path d="M923.1489,327.7042 C923.029,327.9844 922.9089,328.2644 922.7887,328.5443 C922.5482,329.104 922.3071,329.663 922.0654,330.2211 C920.1319,334.6859 918.1613,339.0925 916.18,343.34 C907.29,362.41 895.64,383.49 887.4,397.89 " fill="none" id="App-backto-Submit" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="923.1489,327.7042,915.9304,334.4044,921.1816,332.3009,923.2852,337.5521,923.1489,327.7042" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="913.18" y="364.9084">wrap in HotShot txn</text></g><!--MD5=[0f82fb44ee7a38c1b38d5c85faa7342f]
link HotShotEvents to QueryService--><g id="link_HotShotEvents_QueryService"><path d="M763.91,279.59 C758.71,307.03 748.55,360.65 742.67,391.66 " fill="none" id="HotShotEvents-to-QueryService" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="741.76,396.43,747.3615,388.3292,742.6883,391.5169,739.5006,386.8438,741.76,396.43" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[3cecda08df00f4c5cdab3edfd12ed794]
@startuml
skinparam componentStyle rectangle

frame Legend {
  component "zkevm-node "as is"" as Original #PaleGreen
  component "zkevm-node modified" as Modified #LightPink
  component "new" as New
}

New -[hidden]r-> Original
Original -[hidden]r-> Modified

component User #White
package "HotShot\n(other instances)" as HotShotExternal {
  component "Gossip" as GossipExternal
}

package "Decentralized Sequencer" {
  package "zkEVM app" as zkApp {
    component "Query Service" as QueryService
    component "Submit API" as Submit
    package "Txn-ordering HotShot app" as App {
      package HotShot {
        component "Gossip" as GossipInternal
        component "Events" as HotShotEvents
      }
    }
  }
}

package "L2 Adaptor" as Adaptor {
  interface "JSON-RPC (submit only)" as AdaptorSubmit
}

package "Ethereum L1" as L1 {
  component "Rollup Contract" as Rollup #PaleGreen
  ' component "Bridge L1" as BridgeL1 #PaleGreen
}


package "L2 (zkevm-node)" as L2 {
  component JsonRPC #PaleGreen
  note left of JsonRPC
    Configured to forward transactions
    to the Submit API of the L2 adaptor.
  end note
  database L2DB #PaleGreen [
    L2 Blockchain DB
  ]
  package "Hermez Prover" as HermezProver {
    component Prover #PaleGreen
    component Executor #PaleGreen
    database Tree #PaleGreen [
      L2 State DB
      Merkle Tree
    ]
  }
  'component "Bridge L2" as BridgeL2 #PaleGreen
  component Etherman #PaleGreen
  component Aggregator #PaleGreen
  component "State\nLibrary" as State #PaleGreen
  component Synchronizer #PaleGreen
}

User -> JsonRPC: EVM txn\nEVM query
'User -[hidden]> Submit
'positions the User box in a better place
'User -[hidden]> L2

JsonRPC -up-> AdaptorSubmit: EVM txn
AdaptorSubmit -up-> Submit: EVM txn

GossipInternal <-> GossipExternal

QueryService -> Adaptor: batch
Adaptor -> Rollup: ForceBatches(batch)

JsonRPC - -> State: EVM query

State -> L2DB: read
State - -> Tree: accounts
State - -> Executor: call, etc.

Aggregator - -> State: fetch\nprover\ninput
Aggregator - -> Etherman: proof
Aggregator - -> Prover: generate\nproof
Etherman - -> Rollup: proof
Etherman <- - Rollup: batch\nglobal exit root
Synchronizer <- - Etherman: batch\nglobal exit root
State <- - Synchronizer: batch\nglobal exit root\nstate

' Prover ..> BridgeL2
' User - -> BridgeL1
Submit -up-> App: wrap in HotShot txn
HotShotEvents -down-> QueryService

@enduml

@startuml
skinparam componentStyle rectangle

frame Legend {
  component "zkevm-node "as is"" as Original #PaleGreen
  component "zkevm-node modified" as Modified #LightPink
  component "new" as New
}

New -[hidden]r-> Original
Original -[hidden]r-> Modified

component User #White
package "HotShot\n(other instances)" as HotShotExternal {
  component "Gossip" as GossipExternal
}

package "Decentralized Sequencer" {
  package "zkEVM app" as zkApp {
    component "Query Service" as QueryService
    component "Submit API" as Submit
    package "Txn-ordering HotShot app" as App {
      package HotShot {
        component "Gossip" as GossipInternal
        component "Events" as HotShotEvents
      }
    }
  }
}

package "L2 Adaptor" as Adaptor {
  interface "JSON-RPC (submit only)" as AdaptorSubmit
}

package "Ethereum L1" as L1 {
  component "Rollup Contract" as Rollup #PaleGreen
}


package "L2 (zkevm-node)" as L2 {
  component JsonRPC #PaleGreen
  note left of JsonRPC
    Configured to forward transactions
    to the Submit API of the L2 adaptor.
  end note
  database L2DB #PaleGreen [
    L2 Blockchain DB
  ]
  package "Hermez Prover" as HermezProver {
    component Prover #PaleGreen
    component Executor #PaleGreen
    database Tree #PaleGreen [
      L2 State DB
      Merkle Tree
    ]
  }
  component Etherman #PaleGreen
  component Aggregator #PaleGreen
  component "State\nLibrary" as State #PaleGreen
  component Synchronizer #PaleGreen
}

User -> JsonRPC: EVM txn\nEVM query

JsonRPC -up-> AdaptorSubmit: EVM txn
AdaptorSubmit -up-> Submit: EVM txn

GossipInternal <-> GossipExternal

QueryService -> Adaptor: batch
Adaptor -> Rollup: ForceBatches(batch)

JsonRPC - -> State: EVM query

State -> L2DB: read
State - -> Tree: accounts
State - -> Executor: call, etc.

Aggregator - -> State: fetch\nprover\ninput
Aggregator - -> Etherman: proof
Aggregator - -> Prover: generate\nproof
Etherman - -> Rollup: proof
Etherman <- - Rollup: batch\nglobal exit root
Synchronizer <- - Etherman: batch\nglobal exit root
State <- - Synchronizer: batch\nglobal exit root\nstate

Submit -up-> App: wrap in HotShot txn
HotShotEvents -down-> QueryService

@enduml

PlantUML version 1.2022.13(Sat Nov 19 05:22:17 PST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>