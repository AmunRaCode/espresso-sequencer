<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1257px" preserveAspectRatio="none" style="width:1073px;height:1257px;background:#FFFFFF;" version="1.1" viewBox="0 0 1073 1257" width="1073px" zoomAndPan="magnify"><defs/><g><!--MD5=[f7217341b3bb6bbf768c7f0e049f8d09]
cluster Legend--><g id="cluster_Legend"><rect fill="none" height="87" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1.0;" width="472" x="7" y="151"/><path d="M76,151 L76,160.2969 L66,170.2969 L7,170.2969 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="59" x="10" y="164.9951">Legend</text></g><!--MD5=[3746f487d7820090e32c72dc756be46d]
cluster HotShotExternal--><g id="cluster_HotShotExternal"><path d="M916.5,135 L1053.5,135 A3.75,3.75 0 0 1 1056,137.5 L1063,173.5938 L1063.5,173.5938 A2.5,2.5 0 0 1 1066,176.0938 L1066,235.5 A2.5,2.5 0 0 1 1063.5,238 L916.5,238 A2.5,2.5 0 0 1 914,235.5 L914,137.5 A2.5,2.5 0 0 1 916.5,135 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="914" x2="1063" y1="173.5938" y2="173.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="63" x="954.5" y="149.9951">HotShot</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="136" x="918" y="166.292">(other instances)</text></g><!--MD5=[074479fc2b8718e85f223949db21494f]
cluster Decentralized Sequencer--><g id="cluster_Decentralized Sequencer"><path d="M505.5,6 L706.5,6 A3.75,3.75 0 0 1 709,8.5 L716,28.2969 L887.5,28.2969 A2.5,2.5 0 0 1 890,30.7969 L890,414.5 A2.5,2.5 0 0 1 887.5,417 L505.5,417 A2.5,2.5 0 0 1 503,414.5 L503,8.5 A2.5,2.5 0 0 1 505.5,6 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="503" x2="716" y1="28.2969" y2="28.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="200" x="507" y="20.9951">Decentralized Sequencer</text></g><!--MD5=[bcfbdd31683a7d01cd062dc0c4be3661]
cluster zkApp--><g id="cluster_zkApp"><path d="M529.5,49 L615.5,49 A3.75,3.75 0 0 1 618,51.5 L625,71.2969 L863.5,71.2969 A2.5,2.5 0 0 1 866,73.7969 L866,390.5 A2.5,2.5 0 0 1 863.5,393 L529.5,393 A2.5,2.5 0 0 1 527,390.5 L527,51.5 A2.5,2.5 0 0 1 529.5,49 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="527" x2="625" y1="71.2969" y2="71.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="85" x="531" y="63.9951">zkEVM app</text></g><!--MD5=[975d7fda8cf98ff1a26ca528bf10cecf]
cluster App--><g id="cluster_App"><path d="M561.5,100 L767.5,100 A3.75,3.75 0 0 1 770,102.5 L777,122.2969 L831.5,122.2969 A2.5,2.5 0 0 1 834,124.7969 L834,267.5 A2.5,2.5 0 0 1 831.5,270 L561.5,270 A2.5,2.5 0 0 1 559,267.5 L559,102.5 A2.5,2.5 0 0 1 561.5,100 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="559" x2="777" y1="122.2969" y2="122.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="205" x="563" y="114.9951">Txn-ordering HotShot app</text></g><!--MD5=[583d55fc1e2a49743832e160d5573292]
cluster HotShot--><g id="cluster_HotShot"><path d="M601.5,151 L665.5,151 A3.75,3.75 0 0 1 668,153.5 L675,173.2969 L799.5,173.2969 A2.5,2.5 0 0 1 802,175.7969 L802,235.5 A2.5,2.5 0 0 1 799.5,238 L601.5,238 A2.5,2.5 0 0 1 599,235.5 L599,153.5 A2.5,2.5 0 0 1 601.5,151 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="599" x2="675" y1="173.2969" y2="173.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="63" x="603" y="165.9951">HotShot</text></g><!--MD5=[f5d269121e3c85f4d6e47cf49d169a0a]
cluster Connector--><g id="cluster_Connector"><path d="M480.5,511 L666.5,511 A3.75,3.75 0 0 1 669,513.5 L676,533.2969 L848.5,533.2969 A2.5,2.5 0 0 1 851,535.7969 L851,595.5 A2.5,2.5 0 0 1 848.5,598 L480.5,598 A2.5,2.5 0 0 1 478,595.5 L478,513.5 A2.5,2.5 0 0 1 480.5,511 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="478" x2="676" y1="533.2969" y2="533.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="185" x="482" y="525.9951">Espresso L2 Connector</text></g><!--MD5=[4499c58aefeb8777a4ef8729a6b9746a]
cluster L1--><g id="cluster_L1"><path d="M617.5,1163 L718.5,1163 A3.75,3.75 0 0 1 721,1165.5 L728,1185.2969 L770.5,1185.2969 A2.5,2.5 0 0 1 773,1187.7969 L773,1247.5 A2.5,2.5 0 0 1 770.5,1250 L617.5,1250 A2.5,2.5 0 0 1 615,1247.5 L615,1165.5 A2.5,2.5 0 0 1 617.5,1163 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="615" x2="728" y1="1185.2969" y2="1185.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="100" x="619" y="1177.9951">Ethereum L1</text></g><!--MD5=[30107c386ad61863a1077fa9b8608265]
cluster L2--><g id="cluster_L2"><path d="M256.5,655 L390.5,655 A3.75,3.75 0 0 1 393,657.5 L400,677.2969 L772.5,677.2969 A2.5,2.5 0 0 1 775,679.7969 L775,1103.5 A2.5,2.5 0 0 1 772.5,1106 L256.5,1106 A2.5,2.5 0 0 1 254,1103.5 L254,657.5 A2.5,2.5 0 0 1 256.5,655 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="254" x2="400" y1="677.2969" y2="677.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="133" x="258" y="669.9951">L2 (zkevm-node)</text></g><!--MD5=[72078431e26b572f5b2226d95bfc722b]
cluster HermezProver--><g id="cluster_HermezProver"><path d="M395.5,961 L515.5,961 A3.75,3.75 0 0 1 518,963.5 L525,983.2969 L740.5,983.2969 A2.5,2.5 0 0 1 743,985.7969 L743,1071.5 A2.5,2.5 0 0 1 740.5,1074 L395.5,1074 A2.5,2.5 0 0 1 393,1071.5 L393,963.5 A2.5,2.5 0 0 1 395.5,961 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="393" x2="525" y1="983.2969" y2="983.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="119" x="397" y="975.9951">Hermez Prover</text></g><!--MD5=[72d9b9c3df19f32920b704ceb461b044]
entity Original--><g id="elem_Original"><rect fill="#98FB98" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="151" x="107.5" y="186"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131" x="117.5" y="208.9951">zkevm-node "as is"</text></g><!--MD5=[a113189431ad531dd682dcf46ceaaad4]
entity Modified--><g id="elem_Modified"><rect fill="#FFB6C1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="169" x="293.5" y="186"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="303.5" y="208.9951">zkevm-node modified</text></g><!--MD5=[f6b1c2ab19eda0ce2a089c48ec5bcba4]
entity New--><g id="elem_New"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="49" x="23.5" y="186"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="33.5" y="208.9951">new</text></g><!--MD5=[896ddc638b163aeba3d9eafdbb3e5908]
entity GossipExternal--><g id="elem_GossipExternal"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="930" y="186"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48" x="940" y="208.9951">Gossip</text></g><!--MD5=[1fdded0352c3e8b8e8e5fa4c440e3206]
entity Events--><g id="elem_Events"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="699.5" y="341"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="709.5" y="363.9951">Events</text></g><!--MD5=[fc241586e3e4cf255457dad9b5d09a8f]
entity Submit--><g id="elem_Submit"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="93" x="543.5" y="341"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="553.5" y="363.9951">Submit API</text></g><!--MD5=[72906ce1eb61e5bac7b26d06e51547ad]
entity GossipInternal--><g id="elem_GossipInternal"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="718" y="186"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48" x="728" y="208.9951">Gossip</text></g><!--MD5=[657580825c081e24058a2374906e8018]
entity HotShotEvents--><g id="elem_HotShotEvents"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="615.5" y="186"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="625.5" y="208.9951">Events</text></g><!--MD5=[fe0bae4af69ca8947a410fa6d457e8ef]
entity Adapter--><g id="elem_Adapter"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="193" x="641.5" y="546"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="173" x="651.5" y="568.9951">HotShot-Hermez Adapter</text></g><!--MD5=[50891b5d658e0a5b3a68677ffe19f565]
entity Dispatch--><g id="elem_Dispatch"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112" x="494" y="546"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="504" y="568.9951">RPC dispatch</text></g><!--MD5=[02772cf4a850889cc654a495925d36fb]
entity Rollup--><g id="elem_Rollup"><rect fill="#FFB6C1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="631" y="1198"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="641" y="1220.9951">Rollup Contract</text></g><!--MD5=[ee57f16ef1ba8b49a548a5b41deaf6ed]
entity JsonRPC--><g id="elem_JsonRPC"><rect fill="#98FB98" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78" x="556" y="715.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="566" y="738.4951">JsonRPC</text></g><g id="elem_GMN26"><path d="M297,698 L297,768.5313 A0,0 0 0 0 297,768.5313 L521,768.5313 A0,0 0 0 0 521,768.5313 L521,737.5 L555.53,733.5 L521,729.5 L521,708 L511,698 L297,698 A0,0 0 0 0 297,698 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M511,698 L511,708 L521,708 L511,698 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="303" y="715.0669">Optionally dispatch copy of EVM</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="303" y="730.1997">txns to JsonRPC and attach a</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="303" y="745.3325">fake local mempool for queries</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="303" y="760.4653">with pending txns.</text></g><!--MD5=[58f3bb20197d49c7ea139ae014477a42]
entity L2DB--><g id="elem_L2DB"><path d="M611,844 C611,834 681,834 681,834 C681,834 751,834 751,844 L751,869.2969 C751,879.2969 681,879.2969 681,879.2969 C681,879.2969 611,879.2969 611,869.2969 L611,844 " fill="#98FB98" style="stroke:#181818;stroke-width:0.5;"/><path d="M611,844 C611,854 681,854 681,854 C681,854 751,854 751,844 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="621" y="870.9951">L2 Blockchain DB</text></g><!--MD5=[45978046dcd5eebeac2fa904e53c0036]
entity Etherman--><g id="elem_Etherman"><rect fill="#FFB6C1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87" x="286.5" y="1009"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="296.5" y="1031.9951">Etherman</text></g><!--MD5=[30dc00a6e98b45ee3ed5a73adbca65de]
entity Aggregator--><g id="elem_Aggregator"><rect fill="#98FB98" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="97" x="306.5" y="838.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="316.5" y="861.4951">Aggregator</text></g><!--MD5=[5c691934b5633fdd3b98f008c74cebb5]
entity State--><g id="elem_State"><rect fill="#98FB98" height="52.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="481" y="830"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="491" y="852.9951">State</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="491" y="869.292">Library</text></g><!--MD5=[c3bd79b6cca3d8fa787b3b807ac7237d]
entity Prover--><g id="elem_Prover"><rect fill="#98FB98" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="409" y="1009"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="419" y="1031.9951">Prover</text></g><!--MD5=[77b6810f9f1d8e17e1346401c10c77dc]
entity Executor--><g id="elem_Executor"><rect fill="#98FB98" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="508.5" y="1009"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="518.5" y="1031.9951">Executor</text></g><!--MD5=[47b51ac2f4ace7439b689a6295ba6363]
entity Tree--><g id="elem_Tree"><path d="M625,1006 C625,996 676,996 676,996 C676,996 727,996 727,1006 L727,1047.5938 C727,1057.5938 676,1057.5938 676,1057.5938 C676,1057.5938 625,1057.5938 625,1047.5938 L625,1006 " fill="#98FB98" style="stroke:#181818;stroke-width:0.5;"/><path d="M625,1006 C625,1016 676,1016 676,1016 C676,1016 727,1016 727,1006 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="635" y="1032.9951">L2 State DB</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="635" y="1049.292">Merkle Tree</text></g><!--MD5=[fee662a292a0353a69bd162820bae93b]
entity User--><g id="elem_User"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="52" x="335" y="546"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="345" y="568.9951">User</text></g><!--MD5=[12c5fa856046bf0246c20874f4cc4349]
link New to Original--><!--MD5=[e97aaf9ac7fa8317af7932e9b00233fd]
link Original to Modified--><!--MD5=[56fe027e5cc5d0f185f1b7694283b179]
link User to Dispatch--><g id="link_User_Dispatch"><path d="M387.28,564 C413.06,564 453.35,564 487.38,564 " fill="none" id="User-to-Dispatch" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="492.15,564,483.15,560,487.15,564,483.15,568,492.15,564" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="414.5" y="542.0669">EVM txn</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="417" y="557.1997">queries</text></g><!--MD5=[92f263ad8a52206631cfcfee518f69c1]
link User to L2--><!--MD5=[9c42c1a64afdc0f74ff55abbc2fbb64f]
link Dispatch to JsonRPC--><g id="link_Dispatch_JsonRPC"><path d="M554.65,582.29 C562.76,612.51 579.54,674.94 588.69,709.03 " fill="none" id="Dispatch-to-JsonRPC" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="589.92,713.59,591.4427,703.8596,588.6201,708.7619,583.7178,705.9394,589.92,713.59" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="568" y="627.0669">Queries</text></g><!--MD5=[7daebf69a253423dbe488f39d44c4ffe]
reverse link Submit to Dispatch--><g id="link_Submit_Dispatch"><path d="M585.36,383.55 C577.22,424.84 560.57,509.37 553.4,545.74 " fill="none" id="Submit-backto-Dispatch" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="586.3,378.79,580.6306,386.8435,585.3304,383.6951,588.4788,388.3948,586.3,378.79" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="575" y="468.5669">EVM txn</text></g><!--MD5=[91cafd777a61df7305284aff3f8c2f32]
link GossipInternal to GossipExternal--><g id="link_GossipInternal_GossipExternal"><path d="M792.8,204 C836.28,204 879.76,204 923.24,204 " fill="none" id="GossipInternal-GossipExternal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="928.14,204,919.14,200,923.14,204,919.14,208,928.14,204" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="787.88,204,796.88,208,792.88,204,796.88,200,787.88,204" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d6bb6ce03a9f994459ffb589e7e3403e]
link Events to Adapter--><g id="link_Events_Adapter"><path d="M733.43,377.31 C734.32,413.64 736.4,497.89 737.41,539.24 " fill="none" id="Events-to-Adapter" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="737.54,544.22,741.3073,535.1202,737.4115,539.2217,733.31,535.3258,737.54,544.22" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="755.5" y="446.0669">stream:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="737" y="461.1997">order commit</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19" x="771" y="476.3325">QC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="762.5" y="491.4653">batch</text></g><!--MD5=[f7bb2591de48263be8c8226597d79ad9]
link Adapter to L2DB--><g id="link_Adapter_L2DB"><path d="M734.61,582.3 C725.1,630.74 698.16,768.03 686.5,827.48 " fill="none" id="Adapter-to-L2DB" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="685.58,832.18,691.2494,824.1265,686.5496,827.2749,683.4012,822.5752,685.58,832.18" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="724" y="738.0669">batch</text></g><!--MD5=[959b278cda2aeba0f8481a95d3753114]
link Adapter to Rollup--><g id="link_Adapter_Rollup"><path d="M756.06,582.2 C783.87,610.63 834,670.49 834,732.5 C834,732.5 834,732.5 834,1028 C834,1100.34 766.03,1162.66 724.81,1193.8 " fill="none" id="Adapter-to-Rollup" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="720.89,1196.72,730.4987,1194.5584,724.902,1193.736,725.7243,1188.1393,720.89,1196.72" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="835" y="853.5669">order commit</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19" x="869" y="868.6997">QC</text></g><!--MD5=[a8703da4667deee7d0af4e44f6a9eb71]
link JsonRPC to State--><g id="link_JsonRPC_State"><path d="M583.25,751.84 C570.41,770.79 549.57,801.54 533.92,824.64 " fill="none" id="JsonRPC-to-State" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="531.31,828.48,539.676,823.283,534.1196,824.344,533.0585,818.7876,531.31,828.48" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[23b06c96c58f9e52170abd90e351db28]
link State to L2DB--><g id="link_State_L2DB"><path d="M545.39,856.5 C562.24,856.5 583.62,856.5 604.38,856.5 " fill="none" id="State-to-L2DB" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="609.29,856.5,600.29,852.5,604.29,856.5,600.29,860.5,609.29,856.5" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="563.5" y="849.5669">read</text></g><!--MD5=[afe8f3baa15dd48ff669bede90c045bc]
link State to Tree--><g id="link_State_Tree"><path d="M545.27,876.02 C560.94,885.86 579.46,898.85 594,913 C617.74,936.11 639.5,966.74 654.63,990.29 " fill="none" id="State-to-Tree" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="657.14,994.23,655.6764,984.4905,654.4528,990.0135,648.9299,988.7899,657.14,994.23" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="623" y="933.5669">accounts</text></g><!--MD5=[723ab0c1c62c5caa555c3ea1e025083c]
link State to Executor--><g id="link_State_Executor"><path d="M518.55,883.46 C525.47,915.86 537.21,970.84 543.92,1002.2 " fill="none" id="State-to-Executor" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="544.95,1007.04,546.9889,997.4045,543.9092,1002.1495,539.1641,999.0698,544.95,1007.04" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="532" y="933.5669">call, etc.</text></g><!--MD5=[9c0e57ae8e5f1edce66b3ebcdb296dbe]
link Aggregator to State--><g id="link_Aggregator_State"><path d="M403.69,856.5 C426.37,856.5 452.98,856.5 474.27,856.5 " fill="none" id="Aggregator-to-State" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="479.18,856.5,470.18,852.5,474.18,856.5,470.18,860.5,479.18,856.5" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="426.25" y="819.5669">fetch</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="421.75" y="834.6997">prover</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="426.25" y="849.8325">input</text></g><!--MD5=[5351e065096d48a231f9189815b4e2c0]
link Aggregator to Etherman--><g id="link_Aggregator_Etherman"><path d="M348.61,874.74 C344.88,885.58 340.43,899.92 338,913 C332.34,943.44 330.61,979.19 330.13,1002.19 " fill="none" id="Aggregator-to-Etherman" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="330.04,1007.1,334.1937,998.1699,330.1257,1002.1007,326.1949,998.0328,330.04,1007.1" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="339" y="933.5669">proof</text></g><!--MD5=[134f1ee58a0da627c1fcf646a8cf7cfa]
link Aggregator to Prover--><g id="link_Aggregator_Prover"><path d="M364.16,874.69 C374.28,893.76 391.01,925.47 405,953 C413.48,969.68 422.82,988.64 429.86,1003.05 " fill="none" id="Aggregator-to-Prover" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="431.87,1007.18,431.4983,997.3382,429.6683,1002.6908,424.3156,1000.8609,431.87,1007.18" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="400" y="926.0669">generate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="412.5" y="941.1997">proof</text></g><!--MD5=[0ca7d036d4fc0c343f6b4beaa6721ac7]
link Etherman to Rollup--><g id="link_Etherman_Rollup"><path d="M337.14,1045.2 C346.77,1066.32 365.9,1101.82 393,1122 C461.85,1173.26 559.4,1196.62 624.59,1207.03 " fill="none" id="Etherman-to-Rollup" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="629.31,1207.76,621.0194,1202.4434,624.3676,1207.0029,619.8081,1210.3512,629.31,1207.76" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="429" y="1143.0669">proof</text></g><!--MD5=[eb6b988b0512d6b84233d2583692179c]
reverse link App to Submit--><g id="link_App_Submit"><path d="M576.829,270.3932 C577.3806,274.0628 577.9375,277.7673 578.4944,281.4718 C579.6082,288.8809 580.722,296.2904 581.7941,303.4223 C583.9381,317.6863 585.915,330.84 587.39,340.66 " fill="none" id="App-backto-Submit" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="576.829,270.3932,574.2114,279.8879,577.5723,275.3377,582.1225,278.6986,576.829,270.3932" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="583" y="307.0669">wrap in HotShot txn</text></g><!--MD5=[25a03e75ea8af1b5fbad106de56d561d]
link HotShotEvents to Events--><g id="link_HotShotEvents_Events"><path d="M656.49,222.19 C665.04,240.11 680.52,268.04 701,286 C707.28,291.51 712.75,287.51 718,294 C727.2,305.36 730.94,321.36 732.4,334.53 " fill="none" id="HotShotEvents-to-Events" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="732.81,339.22,736.0222,329.9097,732.3806,334.2385,728.0518,330.5968,732.81,339.22" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[559294250a4970d0ce1c17624cd53ed8]
@startuml
skinparam componentStyle rectangle

frame Legend {
  component "zkevm-node "as is"" as Original #PaleGreen
  component "zkevm-node modified" as Modified #LightPink
  component "new" as New
}

New -[hidden]r-> Original
Original -[hidden]r-> Modified

component User
package "HotShot\n(other instances)" as HotShotExternal {
  component "Gossip" as GossipExternal
}

package "Decentralized Sequencer" {
  package "zkEVM app" as zkApp {
    component Events
    component "Submit API" as Submit
    package "Txn-ordering HotShot app" as App {
      package HotShot {
        component "Gossip" as GossipInternal
        component "Events" as HotShotEvents
      }
    }
  }
}


package "Espresso L2 Connector" as Connector {
  component "HotShot-Hermez Adapter" as Adapter
  component "RPC dispatch" as Dispatch
}

package "Ethereum L1" as L1 {
  component "Rollup Contract" as Rollup #LightPink
  ' component "Bridge L1" as BridgeL1 #PaleGreen
}


package "L2 (zkevm-node)" as L2 {
  component JsonRPC #PaleGreen
  note left of JsonRPC
    Optionally dispatch copy of EVM
    txns to JsonRPC and attach a
    fake local mempool for queries
    with pending txns.
  end note
  database L2DB #PaleGreen [
    L2 Blockchain DB
  ]
  package "Hermez Prover" as HermezProver {
    component Prover #PaleGreen
    component Executor #PaleGreen
    database Tree #PaleGreen [
      L2 State DB
      Merkle Tree
    ]
  }
  'component "Bridge L2" as BridgeL2 #PaleGreen
  component Etherman #LightPink
  component Aggregator #PaleGreen
  component "State\nLibrary" as State #PaleGreen
}

User -> Dispatch: EVM txn\nqueries
'positions the box in a better place
User -[hidden]> L2

Dispatch - -> JsonRPC: Queries
Dispatch -up-> Submit: EVM txn

GossipInternal <-> GossipExternal

Events - -> Adapter: stream:\norder commit\nQC\nbatch

Adapter -> L2DB: batch
Adapter -> Rollup: order commit\nQC

JsonRPC - -> State

State -> L2DB: read
State - -> Tree: accounts
State - -> Executor: call, etc.

Aggregator -> State: fetch\nprover\ninput
Aggregator - -> Etherman: proof
Aggregator -> Prover: generate\nproof
Etherman - -> Rollup: proof

' Prover ..> BridgeL2
' User - -> BridgeL1
Submit -up-> App: wrap in HotShot txn
HotShotEvents -down-> Events

@enduml

@startuml
skinparam componentStyle rectangle

frame Legend {
  component "zkevm-node "as is"" as Original #PaleGreen
  component "zkevm-node modified" as Modified #LightPink
  component "new" as New
}

New -[hidden]r-> Original
Original -[hidden]r-> Modified

component User
package "HotShot\n(other instances)" as HotShotExternal {
  component "Gossip" as GossipExternal
}

package "Decentralized Sequencer" {
  package "zkEVM app" as zkApp {
    component Events
    component "Submit API" as Submit
    package "Txn-ordering HotShot app" as App {
      package HotShot {
        component "Gossip" as GossipInternal
        component "Events" as HotShotEvents
      }
    }
  }
}


package "Espresso L2 Connector" as Connector {
  component "HotShot-Hermez Adapter" as Adapter
  component "RPC dispatch" as Dispatch
}

package "Ethereum L1" as L1 {
  component "Rollup Contract" as Rollup #LightPink
}


package "L2 (zkevm-node)" as L2 {
  component JsonRPC #PaleGreen
  note left of JsonRPC
    Optionally dispatch copy of EVM
    txns to JsonRPC and attach a
    fake local mempool for queries
    with pending txns.
  end note
  database L2DB #PaleGreen [
    L2 Blockchain DB
  ]
  package "Hermez Prover" as HermezProver {
    component Prover #PaleGreen
    component Executor #PaleGreen
    database Tree #PaleGreen [
      L2 State DB
      Merkle Tree
    ]
  }
  component Etherman #LightPink
  component Aggregator #PaleGreen
  component "State\nLibrary" as State #PaleGreen
}

User -> Dispatch: EVM txn\nqueries
User -[hidden]> L2

Dispatch - -> JsonRPC: Queries
Dispatch -up-> Submit: EVM txn

GossipInternal <-> GossipExternal

Events - -> Adapter: stream:\norder commit\nQC\nbatch

Adapter -> L2DB: batch
Adapter -> Rollup: order commit\nQC

JsonRPC - -> State

State -> L2DB: read
State - -> Tree: accounts
State - -> Executor: call, etc.

Aggregator -> State: fetch\nprover\ninput
Aggregator - -> Etherman: proof
Aggregator -> Prover: generate\nproof
Etherman - -> Rollup: proof

Submit -up-> App: wrap in HotShot txn
HotShotEvents -down-> Events

@enduml

PlantUML version 1.2022.12(Sun Oct 23 20:12:26 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>