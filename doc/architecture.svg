<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1320px" preserveAspectRatio="none" style="width:1206px;height:1320px;background:#FFFFFF;" version="1.1" viewBox="0 0 1206 1320" width="1206px" zoomAndPan="magnify"><defs/><g><!--MD5=[f7217341b3bb6bbf768c7f0e049f8d09]
cluster Legend--><g id="cluster_Legend"><rect fill="none" height="269.5" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1.0;" width="350" x="850" y="142.5"/><path d="M919,142.5 L919,151.7969 L909,161.7969 L850,161.7969 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="59" x="853" y="156.4951">Legend</text></g><!--MD5=[3746f487d7820090e32c72dc756be46d]
cluster HotShotExternal--><g id="cluster_HotShotExternal"><path d="M676.5,119 L813.5,119 A3.75,3.75 0 0 1 816,121.5 L823,157.5938 L823.5,157.5938 A2.5,2.5 0 0 1 826,160.0938 L826,254.5 A2.5,2.5 0 0 1 823.5,257 L676.5,257 A2.5,2.5 0 0 1 674,254.5 L674,121.5 A2.5,2.5 0 0 1 676.5,119 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="674" x2="823" y1="157.5938" y2="157.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="63" x="714.5" y="133.9951">HotShot</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="136" x="678" y="150.292">(other instances)</text></g><!--MD5=[074479fc2b8718e85f223949db21494f]
cluster Decentralized Sequencer--><g id="cluster_Decentralized Sequencer"><path d="M265.5,6 L466.5,6 A3.75,3.75 0 0 1 469,8.5 L476,28.2969 L647.5,28.2969 A2.5,2.5 0 0 1 650,30.7969 L650,433.5 A2.5,2.5 0 0 1 647.5,436 L265.5,436 A2.5,2.5 0 0 1 263,433.5 L263,8.5 A2.5,2.5 0 0 1 265.5,6 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="263" x2="476" y1="28.2969" y2="28.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="200" x="267" y="20.9951">Decentralized Sequencer</text></g><!--MD5=[bcfbdd31683a7d01cd062dc0c4be3661]
cluster zkApp--><g id="cluster_zkApp"><path d="M289.5,49 L375.5,49 A3.75,3.75 0 0 1 378,51.5 L385,71.2969 L623.5,71.2969 A2.5,2.5 0 0 1 626,73.7969 L626,409.5 A2.5,2.5 0 0 1 623.5,412 L289.5,412 A2.5,2.5 0 0 1 287,409.5 L287,51.5 A2.5,2.5 0 0 1 289.5,49 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="287" x2="385" y1="71.2969" y2="71.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="85" x="291" y="63.9951">zkEVM app</text></g><!--MD5=[975d7fda8cf98ff1a26ca528bf10cecf]
cluster App--><g id="cluster_App"><path d="M321.5,100 L527.5,100 A3.75,3.75 0 0 1 530,102.5 L537,122.2969 L591.5,122.2969 A2.5,2.5 0 0 1 594,124.7969 L594,286.5 A2.5,2.5 0 0 1 591.5,289 L321.5,289 A2.5,2.5 0 0 1 319,286.5 L319,102.5 A2.5,2.5 0 0 1 321.5,100 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="319" x2="537" y1="122.2969" y2="122.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="205" x="323" y="114.9951">Txn-ordering HotShot app</text></g><!--MD5=[583d55fc1e2a49743832e160d5573292]
cluster HotShot--><g id="cluster_HotShot"><path d="M361.5,151 L425.5,151 A3.75,3.75 0 0 1 428,153.5 L435,173.2969 L559.5,173.2969 A2.5,2.5 0 0 1 562,175.7969 L562,254.5 A2.5,2.5 0 0 1 559.5,257 L361.5,257 A2.5,2.5 0 0 1 359,254.5 L359,153.5 A2.5,2.5 0 0 1 361.5,151 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="359" x2="435" y1="173.2969" y2="173.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="63" x="363" y="165.9951">HotShot</text></g><!--MD5=[f5d269121e3c85f4d6e47cf49d169a0a]
cluster Connector--><g id="cluster_Connector"><path d="M250.5,530 L436.5,530 A3.75,3.75 0 0 1 439,532.5 L446,552.2969 L618.5,552.2969 A2.5,2.5 0 0 1 621,554.7969 L621,633.5 A2.5,2.5 0 0 1 618.5,636 L250.5,636 A2.5,2.5 0 0 1 248,633.5 L248,532.5 A2.5,2.5 0 0 1 250.5,530 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="248" x2="446" y1="552.2969" y2="552.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="185" x="252" y="544.9951">Espresso L2 Connector</text></g><!--MD5=[4499c58aefeb8777a4ef8729a6b9746a]
cluster L1--><g id="cluster_L1"><path d="M235.5,1207 L336.5,1207 A3.75,3.75 0 0 1 339,1209.5 L346,1229.2969 L388.5,1229.2969 A2.5,2.5 0 0 1 391,1231.7969 L391,1310.5 A2.5,2.5 0 0 1 388.5,1313 L235.5,1313 A2.5,2.5 0 0 1 233,1310.5 L233,1209.5 A2.5,2.5 0 0 1 235.5,1207 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="233" x2="346" y1="1229.2969" y2="1229.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="100" x="237" y="1221.9951">Ethereum L1</text></g><!--MD5=[30107c386ad61863a1077fa9b8608265]
cluster L2--><g id="cluster_L2"><path d="M8.5,685 L142.5,685 A3.75,3.75 0 0 1 145,687.5 L152,707.2969 L500.5,707.2969 A2.5,2.5 0 0 1 503,709.7969 L503,1155.5 A2.5,2.5 0 0 1 500.5,1158 L8.5,1158 A2.5,2.5 0 0 1 6,1155.5 L6,687.5 A2.5,2.5 0 0 1 8.5,685 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="152" y1="707.2969" y2="707.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="133" x="10" y="699.9951">L2 (zkevm-node)</text></g><!--MD5=[72078431e26b572f5b2226d95bfc722b]
cluster HermezProver--><g id="cluster_HermezProver"><path d="M131.5,1002 L251.5,1002 A3.75,3.75 0 0 1 254,1004.5 L261,1024.2969 L476.5,1024.2969 A2.5,2.5 0 0 1 479,1026.7969 L479,1131.5 A2.5,2.5 0 0 1 476.5,1134 L131.5,1134 A2.5,2.5 0 0 1 129,1131.5 L129,1004.5 A2.5,2.5 0 0 1 131.5,1002 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="129" x2="261" y1="1024.2969" y2="1024.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="119" x="133" y="1016.9951">Hermez Prover</text></g><!--MD5=[88ac5a349f602fe1f404813fca609a66]
entity from zkevm-node--><g id="elem_from zkevm-node"><rect fill="#98FB98" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="866.5" y="205"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="876.5" y="227.9951">from zkevm-node</text></g><!--MD5=[bdd4bbf83bce11829469bb1563812001]
entity from zkevm-node\nmodified--><g id="elem_from zkevm-node\nmodified"><rect fill="#FFB6C1" height="52.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="1042.5" y="196.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="1052.5" y="219.4951">from zkevm-node</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="1052.5" y="235.792">modified</text></g><!--MD5=[4997e7c3dea50e5fac5b61f4c19450e8]
entity new/to be developed--><g id="elem_new/to be developed"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="167" x="866.5" y="360"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="876.5" y="382.9951">new/to be developed</text></g><!--MD5=[896ddc638b163aeba3d9eafdbb3e5908]
entity GossipExternal--><g id="elem_GossipExternal"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="690" y="205"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48" x="700" y="227.9951">Gossip</text></g><!--MD5=[1fdded0352c3e8b8e8e5fa4c440e3206]
entity Events--><g id="elem_Events"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="454.5" y="360"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="464.5" y="382.9951">Events</text></g><!--MD5=[fc241586e3e4cf255457dad9b5d09a8f]
entity Submit--><g id="elem_Submit"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="93" x="303.5" y="360"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="313.5" y="382.9951">Submit API</text></g><!--MD5=[72906ce1eb61e5bac7b26d06e51547ad]
entity GossipInternal--><g id="elem_GossipInternal"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="478" y="205"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48" x="488" y="227.9951">Gossip</text></g><!--MD5=[657580825c081e24058a2374906e8018]
entity HotShotEvents--><g id="elem_HotShotEvents"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="375.5" y="205"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="385.5" y="227.9951">Events</text></g><!--MD5=[fe0bae4af69ca8947a410fa6d457e8ef]
entity Adapter--><g id="elem_Adapter"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="193" x="411.5" y="584"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="173" x="421.5" y="606.9951">HotShot-Hermez Adapter</text></g><!--MD5=[50891b5d658e0a5b3a68677ffe19f565]
entity Dispatch--><g id="elem_Dispatch"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112" x="264" y="584"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="274" y="606.9951">RPC dispatch</text></g><!--MD5=[02772cf4a850889cc654a495925d36fb]
entity Rollup--><g id="elem_Rollup"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="249" y="1261"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="259" y="1283.9951">Rollup Contract</text></g><!--MD5=[ee57f16ef1ba8b49a548a5b41deaf6ed]
entity JsonRPC--><g id="elem_JsonRPC"><rect fill="#98FB98" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78" x="281" y="756.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="291" y="779.4951">JsonRPC</text></g><g id="elem_GMN24"><path d="M22,739 L22,809.5313 A0,0 0 0 0 22,809.5313 L246,809.5313 A0,0 0 0 0 246,809.5313 L246,778.5 L280.53,774.5 L246,770.5 L246,749 L236,739 L22,739 A0,0 0 0 0 22,739 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M236,739 L236,749 L246,749 L236,739 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="28" y="756.0669">Optionally dispatch copy of EVM</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="28" y="771.1997">txns to JsonRPC and attach a</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="28" y="786.3325">fake local mempool for queries</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="28" y="801.4653">with pending txns.</text></g><!--MD5=[58f3bb20197d49c7ea139ae014477a42]
entity L2DB--><g id="elem_L2DB"><path d="M347,885 C347,875 417,875 417,875 C417,875 487,875 487,885 L487,910.2969 C487,920.2969 417,920.2969 417,920.2969 C417,920.2969 347,920.2969 347,910.2969 L347,885 " fill="#98FB98" style="stroke:#181818;stroke-width:0.5;"/><path d="M347,885 C347,895 417,895 417,895 C417,895 487,895 487,885 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="357" y="911.9951">L2 Blockchain DB</text></g><!--MD5=[45978046dcd5eebeac2fa904e53c0036]
entity Etherman--><g id="elem_Etherman"><rect fill="#FFB6C1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87" x="22.5" y="1069"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="32.5" y="1091.9951">Etherman</text></g><!--MD5=[30dc00a6e98b45ee3ed5a73adbca65de]
entity Aggregator--><g id="elem_Aggregator"><rect fill="#98FB98" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="97" x="42.5" y="879.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="52.5" y="902.4951">Aggregator</text></g><!--MD5=[5c691934b5633fdd3b98f008c74cebb5]
entity State--><g id="elem_State"><rect fill="#98FB98" height="52.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="217" y="871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="227" y="893.9951">State</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="227" y="910.292">Library</text></g><!--MD5=[c3bd79b6cca3d8fa787b3b807ac7237d]
entity Prover--><g id="elem_Prover"><rect fill="#98FB98" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="145" y="1069"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="155" y="1091.9951">Prover</text></g><!--MD5=[77b6810f9f1d8e17e1346401c10c77dc]
entity Executor--><g id="elem_Executor"><rect fill="#98FB98" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="244.5" y="1069"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="254.5" y="1091.9951">Executor</text></g><!--MD5=[47b51ac2f4ace7439b689a6295ba6363]
entity Tree--><g id="elem_Tree"><path d="M361,1066 C361,1056 412,1056 412,1056 C412,1056 463,1056 463,1066 L463,1107.5938 C463,1117.5938 412,1117.5938 412,1117.5938 C412,1117.5938 361,1117.5938 361,1107.5938 L361,1066 " fill="#98FB98" style="stroke:#181818;stroke-width:0.5;"/><path d="M361,1066 C361,1076 412,1076 412,1076 C412,1076 463,1076 463,1066 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="371" y="1092.9951">L2 State DB</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="371" y="1109.292">Merkle Tree</text></g><!--MD5=[fee662a292a0353a69bd162820bae93b]
entity User--><g id="elem_User"><rect fill="#F1F1F1" height="36.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="52" x="640" y="584"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="650" y="606.9951">User</text></g><!--MD5=[56fe027e5cc5d0f185f1b7694283b179]
link User to Dispatch--><g id="link_User_Dispatch"><path d="M667.61,583.79 C668.69,558.79 666.29,514.52 639,493.17 C595.82,459.39 442.44,496.34 394,522 C369.09,535.19 348.11,560.13 334.92,578.67 " fill="none" id="User-to-Dispatch" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="332.28,582.47,340.6954,577.3532,335.129,578.3611,334.1211,572.7948,332.28,582.47" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="586" y="480.0669">EVM txn</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="588.5" y="495.1997">queries</text></g><!--MD5=[9c42c1a64afdc0f74ff55abbc2fbb64f]
link Dispatch to JsonRPC--><g id="link_Dispatch_JsonRPC"><path d="M320,620.29 C320,651.05 320,715.32 320,750.04 " fill="none" id="Dispatch-to-JsonRPC" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="320,754.65,324,745.65,320,749.65,316,745.65,320,754.65" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="321" y="665.0669">Queries</text></g><!--MD5=[7daebf69a253423dbe488f39d44c4ffe]
reverse link Submit to Dispatch--><g id="link_Submit_Dispatch"><path d="M346.8,402.66 C340.73,447.56 327.68,544.18 322.34,583.66 " fill="none" id="Submit-backto-Dispatch" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="347.44,397.92,342.2682,406.3017,346.7689,402.8748,350.1958,407.3754,347.44,397.92" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="341" y="487.5669">EVM txn</text></g><!--MD5=[91cafd777a61df7305284aff3f8c2f32]
link GossipInternal to GossipExternal--><g id="link_GossipInternal_GossipExternal"><path d="M552.8,223 C596.28,223 639.76,223 683.24,223 " fill="none" id="GossipInternal-GossipExternal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="688.14,223,679.14,219,683.14,223,679.14,227,688.14,223" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="547.88,223,556.88,227,552.88,223,556.88,219,547.88,223" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d6bb6ce03a9f994459ffb589e7e3403e]
link Events to Adapter--><g id="link_Events_Adapter"><path d="M486.77,396.12 C485.2,421.82 483.22,471.85 488,514 C490.47,535.81 496.33,560.11 501.07,577.47 " fill="none" id="Events-to-Adapter" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="502.35,582.08,503.8117,572.3402,501.0199,577.2602,496.0999,574.4684,502.35,582.08" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="507.5" y="465.0669">stream:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="489" y="480.1997">order commit</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19" x="523" y="495.3325">QC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="514.5" y="510.4653">batch</text></g><!--MD5=[f7bb2591de48263be8c8226597d79ad9]
link Adapter to L2DB--><g id="link_Adapter_L2DB"><path d="M502.58,620.48 C487.37,669.54 444.19,808.8 425.64,868.63 " fill="none" id="Adapter-to-L2DB" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="424.16,873.4,430.6485,865.9906,425.6424,868.6248,423.0083,863.6187,424.16,873.4" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="485" y="779.0669">batch</text></g><!--MD5=[959b278cda2aeba0f8481a95d3753114]
link Adapter to Rollup--><g id="link_Adapter_Rollup"><path d="M516.54,620.44 C530.57,650.79 557,715.6 557,773.5 C557,773.5 557,773.5 557,1088 C557,1178.7 450.84,1232.32 378.28,1258.38 " fill="none" id="Adapter-to-Rollup" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="373.67,1260,383.4872,1260.789,378.3871,1258.3419,380.8342,1253.2417,373.67,1260" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="558" y="894.5669">order commit</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19" x="592" y="909.6997">QC</text></g><!--MD5=[a8703da4667deee7d0af4e44f6a9eb71]
link JsonRPC to State--><g id="link_JsonRPC_State"><path d="M309.83,792.84 C298.75,811.71 280.81,842.28 267.28,865.35 " fill="none" id="JsonRPC-to-State" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="264.88,869.43,272.8959,863.7076,267.4188,865.1225,266.0039,859.6455,264.88,869.43" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[23b06c96c58f9e52170abd90e351db28]
link State to L2DB--><g id="link_State_L2DB"><path d="M281.39,897.5 C298.24,897.5 319.62,897.5 340.38,897.5 " fill="none" id="State-to-L2DB" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="345.29,897.5,336.29,893.5,340.29,897.5,336.29,901.5,345.29,897.5" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="299.5" y="890.5669">read</text></g><!--MD5=[afe8f3baa15dd48ff669bede90c045bc]
link State to Tree--><g id="link_State_Tree"><path d="M281.21,917.03 C296.49,926.79 314.34,939.7 328,954 C355.53,982.82 379.09,1021.96 394.2,1050.13 " fill="none" id="State-to-Tree" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="396.39,1054.27,395.7039,1044.4451,394.046,1049.8535,388.6375,1048.1955,396.39,1054.27" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="354" y="974.5669">accounts</text></g><!--MD5=[723ab0c1c62c5caa555c3ea1e025083c]
link State to Executor--><g id="link_State_Executor"><path d="M253.93,924.18 C260.95,960.72 273.71,1027.19 280.49,1062.5 " fill="none" id="State-to-Executor" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="281.4,1067.23,283.6325,1057.6375,280.4579,1062.3196,275.7758,1059.1449,281.4,1067.23" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="266" y="974.5669">call, etc.</text></g><!--MD5=[9c0e57ae8e5f1edce66b3ebcdb296dbe]
link Aggregator to State--><g id="link_Aggregator_State"><path d="M139.69,897.5 C162.37,897.5 188.98,897.5 210.27,897.5 " fill="none" id="Aggregator-to-State" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="215.18,897.5,206.18,893.5,210.18,897.5,206.18,901.5,215.18,897.5" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="162.25" y="860.5669">fetch</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="157.75" y="875.6997">prover</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="162.25" y="890.8325">input</text></g><!--MD5=[5351e065096d48a231f9189815b4e2c0]
link Aggregator to Etherman--><g id="link_Aggregator_Etherman"><path d="M84.56,915.74 C80.81,926.56 76.37,940.91 74,954 C67.22,991.49 65.87,1035.84 65.76,1062.4 " fill="none" id="Aggregator-to-Etherman" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="65.75,1067.24,69.7757,1058.2515,65.7643,1062.24,61.7757,1058.2286,65.75,1067.24" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="75" y="974.5669">proof</text></g><!--MD5=[134f1ee58a0da627c1fcf646a8cf7cfa]
link Aggregator to Prover--><g id="link_Aggregator_Prover"><path d="M100.8,915.82 C111.33,934.73 128.27,966.07 141,994 C151.48,1017 161.82,1044 168.71,1062.78 " fill="none" id="Aggregator-to-Prover" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="170.4,1067.39,171.0739,1057.5642,168.6867,1062.6927,163.5582,1060.3055,170.4,1067.39" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="138" y="967.0669">generate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="150.5" y="982.1997">proof</text></g><!--MD5=[0ca7d036d4fc0c343f6b4beaa6721ac7]
link Etherman to Rollup--><g id="link_Etherman_Rollup"><path d="M77.32,1105.25 C88.93,1122.08 108.2,1147.74 129,1166 C172.76,1204.41 231.31,1237.67 270.27,1257.75 " fill="none" id="Etherman-to-Rollup" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="274.53,1259.92,268.3274,1252.2696,270.0751,1257.6497,264.695,1259.3974,274.53,1259.92" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="158" y="1187.0669">proof</text></g><!--MD5=[eb6b988b0512d6b84233d2583692179c]
reverse link App to Submit--><g id="link_App_Submit"><path d="M336.829,289.3932 C337.3806,293.0628 337.9375,296.7673 338.4944,300.4718 C339.6082,307.8809 340.722,315.2904 341.7941,322.4223 C343.9381,336.6863 345.915,349.84 347.39,359.66 " fill="none" id="App-backto-Submit" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="336.829,289.3932,334.2114,298.8879,337.5723,294.3377,342.1225,297.6986,336.829,289.3932" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="344" y="326.0669">wrap in HotShot txn</text></g><!--MD5=[25a03e75ea8af1b5fbad106de56d561d]
link HotShotEvents to Events--><g id="link_HotShotEvents_Events"><path d="M416.42,241.28 C424.9,259.27 440.33,287.26 461,305 C467.64,310.7 473.73,306.01 479,313 C487.59,324.39 489.87,340.26 489.98,353.35 " fill="none" id="HotShotEvents-to-Events" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="489.91,358,494.0382,349.0581,489.9814,353.0005,486.039,348.9438,489.91,358" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[92bca851aeb50f52b58e6ce7f93a645e]
@startuml
skinparam componentStyle rectangle

frame Legend {
  component "from zkevm-node" #PaleGreen
  component "from zkevm-node\nmodified" #LightPink
  component "new/to be developed"
}

component User
package "HotShot\n(other instances)" as HotShotExternal {
  component "Gossip" as GossipExternal
}

package "Decentralized Sequencer" {
  package "zkEVM app" as zkApp {
    component Events
    component "Submit API" as Submit
    package "Txn-ordering HotShot app" as App {
      package HotShot {
        component "Gossip" as GossipInternal
        component "Events" as HotShotEvents
      }
    }
  }
}


package "Espresso L2 Connector" as Connector {
  component "HotShot-Hermez Adapter" as Adapter
  component "RPC dispatch" as Dispatch
}

package "Ethereum L1" as L1 {
  component "Rollup Contract" as Rollup
  ' component "Bridge L1" as BridgeL1 #PaleGreen
}


package "L2 (zkevm-node)" as L2 {
  component JsonRPC #PaleGreen
  note left of JsonRPC
    Optionally dispatch copy of EVM
    txns to JsonRPC and attach a
    fake local mempool for queries
    with pending txns.
  end note
  database L2DB #PaleGreen [
    L2 Blockchain DB
  ]
  package "Hermez Prover" as HermezProver {
    component Prover #PaleGreen
    component Executor #PaleGreen
    database Tree #PaleGreen [
      L2 State DB
      Merkle Tree
    ]
  }
  'component "Bridge L2" as BridgeL2 #PaleGreen
  component Etherman #LightPink
  component Aggregator #PaleGreen
  component "State\nLibrary" as State #PaleGreen
}

User -> Dispatch: EVM txn\nqueries
Dispatch - -> JsonRPC: Queries
Dispatch -up-> Submit: EVM txn

GossipInternal <-> GossipExternal

Events - -> Adapter: stream:\norder commit\nQC\nbatch

Adapter -> L2DB: batch
Adapter -> Rollup: order commit\nQC

JsonRPC - -> State

State -> L2DB: read
State - -> Tree: accounts
State - -> Executor: call, etc.

Aggregator -> State: fetch\nprover\ninput
Aggregator - -> Etherman: proof
Aggregator -> Prover: generate\nproof
Etherman - -> Rollup: proof

' Prover ..> BridgeL2
' User - -> BridgeL1
Submit -up-> App: wrap in HotShot txn
HotShotEvents -down-> Events

@enduml

@startuml
skinparam componentStyle rectangle

frame Legend {
  component "from zkevm-node" #PaleGreen
  component "from zkevm-node\nmodified" #LightPink
  component "new/to be developed"
}

component User
package "HotShot\n(other instances)" as HotShotExternal {
  component "Gossip" as GossipExternal
}

package "Decentralized Sequencer" {
  package "zkEVM app" as zkApp {
    component Events
    component "Submit API" as Submit
    package "Txn-ordering HotShot app" as App {
      package HotShot {
        component "Gossip" as GossipInternal
        component "Events" as HotShotEvents
      }
    }
  }
}


package "Espresso L2 Connector" as Connector {
  component "HotShot-Hermez Adapter" as Adapter
  component "RPC dispatch" as Dispatch
}

package "Ethereum L1" as L1 {
  component "Rollup Contract" as Rollup
}


package "L2 (zkevm-node)" as L2 {
  component JsonRPC #PaleGreen
  note left of JsonRPC
    Optionally dispatch copy of EVM
    txns to JsonRPC and attach a
    fake local mempool for queries
    with pending txns.
  end note
  database L2DB #PaleGreen [
    L2 Blockchain DB
  ]
  package "Hermez Prover" as HermezProver {
    component Prover #PaleGreen
    component Executor #PaleGreen
    database Tree #PaleGreen [
      L2 State DB
      Merkle Tree
    ]
  }
  component Etherman #LightPink
  component Aggregator #PaleGreen
  component "State\nLibrary" as State #PaleGreen
}

User -> Dispatch: EVM txn\nqueries
Dispatch - -> JsonRPC: Queries
Dispatch -up-> Submit: EVM txn

GossipInternal <-> GossipExternal

Events - -> Adapter: stream:\norder commit\nQC\nbatch

Adapter -> L2DB: batch
Adapter -> Rollup: order commit\nQC

JsonRPC - -> State

State -> L2DB: read
State - -> Tree: accounts
State - -> Executor: call, etc.

Aggregator -> State: fetch\nprover\ninput
Aggregator - -> Etherman: proof
Aggregator -> Prover: generate\nproof
Etherman - -> Rollup: proof

Submit -up-> App: wrap in HotShot txn
HotShotEvents -down-> Events

@enduml

PlantUML version 1.2022.12(Sun Oct 23 20:12:26 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>